<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TinyMUSH: src/netmush/db_flatfile.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TinyMUSH<span id="projectnumber">&#160;3.3</span>
   </div>
   <div id="projectbrief">TinyMUSH Server</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d49c5bdcdc946239a893bf2d58085e26.html">netmush</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">db_flatfile.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Flatfile persistence: reading/writing database dumps and format conversion.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;config.h&quot;</code><br />
<code>#include &quot;<a class="el" href="constants_8h_source.html">constants.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="typedefs_8h_source.html">typedefs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="externs_8h_source.html">externs.h</a>&quot;</code><br />
<code>#include &quot;prototypes.h&quot;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for db_flatfile.c:</div>
<div class="dyncontent">
<div class="center"><img src="db__flatfile_8c__incl.png" border="0" usemap="#asrc_2netmush_2db__flatfile_8c" alt=""/></div>
<map name="asrc_2netmush_2db__flatfile_8c" id="asrc_2netmush_2db__flatfile_8c">
<area shape="rect" title="Flatfile persistence: reading/writing database dumps and format conversion." alt="" coords="535,5,696,31"/>
<area shape="rect" title=" " alt="" coords="5,79,71,105"/>
<area shape="poly" title=" " alt="" coords="534,28,335,46,212,62,87,81,86,76,212,56,334,41,534,22"/>
<area shape="rect" href="constants_8h.html" title="Global numeric and string constants for flags, limits, and parser tokens." alt="" coords="95,79,184,105"/>
<area shape="poly" title=" " alt="" coords="534,33,202,82,200,82,199,77,202,76,534,28"/>
<area shape="rect" href="typedefs_8h.html" title="Core typedefs for dbrefs, flags, buffers, and engine data structures." alt="" coords="338,153,418,178"/>
<area shape="poly" title=" " alt="" coords="535,25,500,32,465,43,431,59,403,81,393,93,387,108,381,138,376,137,382,106,389,91,399,77,428,54,463,38,499,27,534,20"/>
<area shape="rect" title=" " alt="" coords="157,226,231,252"/>
<area shape="poly" title=" " alt="" coords="535,32,466,47,390,70,314,106,279,128,248,155,224,184,207,214,203,211,220,181,244,151,276,124,312,101,388,65,465,41,534,27"/>
<area shape="rect" href="macros_8h.html" title="Engine&#45;wide macros for memory tracking, flag checks, logging, and utilities." alt="" coords="578,79,652,105"/>
<area shape="poly" title=" " alt="" coords="618,31,618,63,613,63,613,31"/>
<area shape="rect" href="externs_8h.html" title="Shared extern declarations and globals used across the game engine." alt="" coords="676,79,749,105"/>
<area shape="poly" title=" " alt="" coords="633,29,686,68,683,72,630,34"/>
<area shape="rect" href="prototypes_8h_source.html" title=" " alt="" coords="412,79,504,105"/>
<area shape="poly" title=" " alt="" coords="590,34,500,75,498,70,588,29"/>
<area shape="rect" title=" " alt="" coords="684,153,746,178"/>
<area shape="poly" title=" " alt="" coords="601,33,585,48,571,66,564,85,568,103,583,116,609,128,670,149,669,155,606,133,580,120,564,106,559,85,567,64,582,45,598,29"/>
<area shape="rect" title=" " alt="" coords="774,79,836,105"/>
<area shape="poly" title=" " alt="" coords="648,29,760,71,758,76,647,34"/>
<area shape="rect" title=" " alt="" coords="860,79,917,105"/>
<area shape="poly" title=" " alt="" coords="665,29,846,76,845,81,663,34"/>
<area shape="rect" title=" " alt="" coords="941,79,1004,105"/>
<area shape="poly" title=" " alt="" coords="687,29,926,76,925,81,686,34"/>
<area shape="rect" title=" " alt="" coords="1028,79,1088,105"/>
<area shape="poly" title=" " alt="" coords="697,26,841,45,1013,76,1012,81,840,51,696,31"/>
<area shape="rect" title=" " alt="" coords="1112,79,1174,105"/>
<area shape="poly" title=" " alt="" coords="697,23,877,42,986,57,1097,76,1097,81,985,62,876,47,696,29"/>
<area shape="rect" title=" " alt="" coords="112,153,167,178"/>
<area shape="poly" title=" " alt="" coords="142,105,142,137,137,137,137,105"/>
<area shape="rect" title=" " alt="" coords="254,226,318,252"/>
<area shape="poly" title=" " alt="" coords="364,181,315,219,312,215,361,177"/>
<area shape="rect" title=" " alt="" coords="635,226,694,252"/>
<area shape="poly" title=" " alt="" coords="419,174,620,223,619,228,418,179"/>
<area shape="poly" title=" " alt="" coords="348,181,240,223,238,218,346,176"/>
<area shape="rect" title=" " alt="" coords="342,226,398,252"/>
<area shape="poly" title=" " alt="" coords="379,179,376,211,370,211,374,178"/>
<area shape="rect" title=" " alt="" coords="422,226,502,252"/>
<area shape="poly" title=" " alt="" coords="394,177,438,214,435,218,391,181"/>
<area shape="rect" title=" " alt="" coords="526,226,611,252"/>
<area shape="poly" title=" " alt="" coords="411,176,523,218,521,223,409,181"/>
<area shape="poly" title=" " alt="" coords="446,107,404,144,401,140,443,103"/>
<area shape="poly" title=" " alt="" coords="505,98,565,116,596,131,624,151,646,180,660,211,655,213,642,182,620,155,593,135,563,121,503,103"/>
<area shape="poly" title=" " alt="" coords="461,105,464,211,459,211,456,105"/>
<area shape="poly" title=" " alt="" coords="469,103,552,212,548,216,465,107"/>
<area shape="poly" title=" " alt="" coords="502,103,670,149,669,154,501,108"/>
<area shape="rect" title=" " alt="" coords="543,153,610,178"/>
<area shape="poly" title=" " alt="" coords="479,103,545,142,542,147,477,107"/>
<area shape="rect" href="ansi_8h_source.html" title=" " alt="" coords="258,153,314,178"/>
<area shape="poly" title=" " alt="" coords="430,108,329,149,327,144,428,103"/>
<area shape="poly" title=" " alt="" coords="289,179,289,211,283,211,283,179"/>
<area shape="poly" title=" " alt="" coords="272,181,223,219,220,215,269,177"/>
<area shape="rect" title=" " alt="" coords="66,226,133,252"/>
<area shape="poly" title=" " alt="" coords="259,180,146,223,145,218,257,175"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abc48f11473ca52157d1e8d48a6fac2e1" id="r_abc48f11473ca52157d1e8d48a6fac2e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structboolexp.html">BOOLEXP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc48f11473ca52157d1e8d48a6fac2e1">getboolexp1</a> (FILE *f)</td></tr>
<tr class="memdesc:abc48f11473ca52157d1e8d48a6fac2e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get boolean subexpression from file.  <br /></td></tr>
<tr class="separator:abc48f11473ca52157d1e8d48a6fac2e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add7c2b24bbc4798a914920521426df5f" id="r_add7c2b24bbc4798a914920521426df5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structboolexp.html">BOOLEXP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add7c2b24bbc4798a914920521426df5f">getboolexp</a> (FILE *f)</td></tr>
<tr class="memdesc:add7c2b24bbc4798a914920521426df5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a boolean expression from the flat file.  <br /></td></tr>
<tr class="separator:add7c2b24bbc4798a914920521426df5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace43463abf879b917fd2731e78fc85aa" id="r_ace43463abf879b917fd2731e78fc85aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace43463abf879b917fd2731e78fc85aa">unscramble_attrnum</a> (int attrnum)</td></tr>
<tr class="memdesc:ace43463abf879b917fd2731e78fc85aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fix up attribute numbers from foreign muds.  <br /></td></tr>
<tr class="separator:ace43463abf879b917fd2731e78fc85aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba098d01bcc5234392cd6cb6fb1c972c" id="r_aba098d01bcc5234392cd6cb6fb1c972c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba098d01bcc5234392cd6cb6fb1c972c">get_list</a> (FILE *f, dbref i, int new_strings)</td></tr>
<tr class="memdesc:aba098d01bcc5234392cd6cb6fb1c972c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read attribute list from flat file.  <br /></td></tr>
<tr class="separator:aba098d01bcc5234392cd6cb6fb1c972c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e46310a02c793dea266c368b2e0c665" id="r_a2e46310a02c793dea266c368b2e0c665"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e46310a02c793dea266c368b2e0c665">putbool_subexp</a> (FILE *f, <a class="el" href="structboolexp.html">BOOLEXP</a> *b)</td></tr>
<tr class="memdesc:a2e46310a02c793dea266c368b2e0c665"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a boolean sub-expression to the flat file.  <br /></td></tr>
<tr class="separator:a2e46310a02c793dea266c368b2e0c665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae115b79a58100ccf65793ae2b39db2fd" id="r_ae115b79a58100ccf65793ae2b39db2fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae115b79a58100ccf65793ae2b39db2fd">putboolexp</a> (FILE *f, <a class="el" href="structboolexp.html">BOOLEXP</a> *b)</td></tr>
<tr class="memdesc:ae115b79a58100ccf65793ae2b39db2fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write boolean expression to the flat file.  <br /></td></tr>
<tr class="separator:ae115b79a58100ccf65793ae2b39db2fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a748779c1770afe9b83673780bf385583" id="r_a748779c1770afe9b83673780bf385583"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a748779c1770afe9b83673780bf385583">upgrade_flags</a> (FLAG *flags1, FLAG *flags2, FLAG *flags3, dbref thing, int db_format, int db_version)</td></tr>
<tr class="memdesc:a748779c1770afe9b83673780bf385583"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert foreign flags to MUSH format.  <br /></td></tr>
<tr class="separator:a748779c1770afe9b83673780bf385583"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9f096bb89fd27e023ec66aeefdfa6f" id="r_a0e9f096bb89fd27e023ec66aeefdfa6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e9f096bb89fd27e023ec66aeefdfa6f">efo_convert</a> (void)</td></tr>
<tr class="memdesc:a0e9f096bb89fd27e023ec66aeefdfa6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fix things up for Exits-From-Objects.  <br /></td></tr>
<tr class="separator:a0e9f096bb89fd27e023ec66aeefdfa6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1ae8d0c7cc371aca3d3242ae307397" id="r_ade1ae8d0c7cc371aca3d3242ae307397"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ade1ae8d0c7cc371aca3d3242ae307397">fix_mux_zones</a> (void)</td></tr>
<tr class="memdesc:ade1ae8d0c7cc371aca3d3242ae307397"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert MUX-style zones to 3.0-style zones.  <br /></td></tr>
<tr class="separator:ade1ae8d0c7cc371aca3d3242ae307397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1ef48c56451022d41a399c71360210" id="r_a0a1ef48c56451022d41a399c71360210"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a1ef48c56451022d41a399c71360210">fix_typed_quotas</a> (void)</td></tr>
<tr class="memdesc:a0a1ef48c56451022d41a399c71360210"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explode standard quotas into typed quotas.  <br /></td></tr>
<tr class="separator:a0a1ef48c56451022d41a399c71360210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a850d602c8ad86e2de86992986370a667" id="r_a850d602c8ad86e2de86992986370a667"><td class="memItemLeft" align="right" valign="top">dbref&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a850d602c8ad86e2de86992986370a667">db_read_flatfile</a> (FILE *f, int *db_format, int *db_version, int *db_flags)</td></tr>
<tr class="memdesc:a850d602c8ad86e2de86992986370a667"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a flatfile.  <br /></td></tr>
<tr class="separator:a850d602c8ad86e2de86992986370a667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa51b4a7bd45cad467913b376bdae48b" id="r_afa51b4a7bd45cad467913b376bdae48b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa51b4a7bd45cad467913b376bdae48b">db_read</a> (void)</td></tr>
<tr class="memdesc:afa51b4a7bd45cad467913b376bdae48b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a DB.  <br /></td></tr>
<tr class="separator:afa51b4a7bd45cad467913b376bdae48b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2d94718094444b66c24f3c841911946" id="r_af2d94718094444b66c24f3c841911946"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2d94718094444b66c24f3c841911946">db_write_object_out</a> (FILE *f, dbref i, int db_format <a class="el" href="typedefs_8h.html#ad6e0fca9cb4682ac2a9b32277cbe94b6">__attribute__</a>((unused)), int flags, int *n_atrt)</td></tr>
<tr class="memdesc:af2d94718094444b66c24f3c841911946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write an object to a DB.  <br /></td></tr>
<tr class="separator:af2d94718094444b66c24f3c841911946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d1bddbab6656f3506368a11feee62a4" id="r_a6d1bddbab6656f3506368a11feee62a4"><td class="memItemLeft" align="right" valign="top">dbref&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d1bddbab6656f3506368a11feee62a4">db_write_flatfile</a> (FILE *f, int format, int version)</td></tr>
<tr class="memdesc:a6d1bddbab6656f3506368a11feee62a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a db to Flat File.  <br /></td></tr>
<tr class="separator:a6d1bddbab6656f3506368a11feee62a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b2fe2b1852143ff0ee2a0140f9c05a" id="r_ae3b2fe2b1852143ff0ee2a0140f9c05a"><td class="memItemLeft" align="right" valign="top">dbref&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3b2fe2b1852143ff0ee2a0140f9c05a">db_write</a> (void)</td></tr>
<tr class="memdesc:ae3b2fe2b1852143ff0ee2a0140f9c05a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write DB to file.  <br /></td></tr>
<tr class="separator:ae3b2fe2b1852143ff0ee2a0140f9c05a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84d08c9d7f0a7af354234e230b7c510d" id="r_a84d08c9d7f0a7af354234e230b7c510d"><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84d08c9d7f0a7af354234e230b7c510d">db_module_flatfile</a> (char *filename, bool wrflag)</td></tr>
<tr class="memdesc:a84d08c9d7f0a7af354234e230b7c510d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a file pointer for a module to use when writing a flatfile.  <br /></td></tr>
<tr class="separator:a84d08c9d7f0a7af354234e230b7c510d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a81abf5d67af4cc116d290a1d21c750d4" id="r_a81abf5d67af4cc116d290a1d21c750d4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structobject.html">object</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81abf5d67af4cc116d290a1d21c750d4">db</a></td></tr>
<tr class="separator:a81abf5d67af4cc116d290a1d21c750d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9cfd5d6e7f39264a6fa72ebbc4500b6" id="r_aa9cfd5d6e7f39264a6fa72ebbc4500b6"><td class="memItemLeft" align="right" valign="top"><a id="aa9cfd5d6e7f39264a6fa72ebbc4500b6" name="aa9cfd5d6e7f39264a6fa72ebbc4500b6"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_version</b></td></tr>
<tr class="separator:aa9cfd5d6e7f39264a6fa72ebbc4500b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed3638d2c1363e972676c9c5efc51f64" id="r_aed3638d2c1363e972676c9c5efc51f64"><td class="memItemLeft" align="right" valign="top"><a id="aed3638d2c1363e972676c9c5efc51f64" name="aed3638d2c1363e972676c9c5efc51f64"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_format</b></td></tr>
<tr class="separator:aed3638d2c1363e972676c9c5efc51f64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6fd34ad950178f0aadf5780dbfa31b7" id="r_aa6fd34ad950178f0aadf5780dbfa31b7"><td class="memItemLeft" align="right" valign="top"><a id="aa6fd34ad950178f0aadf5780dbfa31b7" name="aa6fd34ad950178f0aadf5780dbfa31b7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_flags</b></td></tr>
<tr class="separator:aa6fd34ad950178f0aadf5780dbfa31b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1323df38074b528092a5ea1f2658ff2a" id="r_a1323df38074b528092a5ea1f2658ff2a"><td class="memItemLeft" align="right" valign="top"><a id="a1323df38074b528092a5ea1f2658ff2a" name="a1323df38074b528092a5ea1f2658ff2a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>anum_alc_top</b></td></tr>
<tr class="separator:a1323df38074b528092a5ea1f2658ff2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8756d097979630c20e8815f9cf50b603" id="r_a8756d097979630c20e8815f9cf50b603"><td class="memItemLeft" align="right" valign="top"><a id="a8756d097979630c20e8815f9cf50b603" name="a8756d097979630c20e8815f9cf50b603"></a>
int *&#160;</td><td class="memItemRight" valign="bottom"><b>used_attrs_table</b></td></tr>
<tr class="separator:a8756d097979630c20e8815f9cf50b603"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Flatfile persistence: reading/writing database dumps and format conversion. </p>
<dl class="section author"><dt>Author</dt><dd>TinyMUSH development team (<a href="https://github.com/TinyMUSH">https://github.com/TinyMUSH</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>4.0</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (C) 1989-2025 TinyMUSH development team. You may distribute under the terms the Artistic License, as specified in the COPYING file. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a84d08c9d7f0a7af354234e230b7c510d" name="a84d08c9d7f0a7af354234e230b7c510d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84d08c9d7f0a7af354234e230b7c510d">&#9670;&#160;</a></span>db_module_flatfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE * db_module_flatfile </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>wrflag</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a file pointer for a module to use when writing a flatfile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Filename </td></tr>
    <tr><td class="paramname">wrflag</td><td>Open for write or read access. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>FILE* </dd></dl>

</div>
</div>
<a id="afa51b4a7bd45cad467913b376bdae48b" name="afa51b4a7bd45cad467913b376bdae48b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa51b4a7bd45cad467913b376bdae48b">&#9670;&#160;</a></span>db_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_read </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a DB. </p>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<p>Fetch the database info</p>
<p>Unroll the data returned</p>
<p>Load the attribute numbers</p>
<p>Unroll the data into flags and name</p>
<p>Houston, we have a problem</p>
<p>Load the object structures</p>
<p>Unroll the data into objnum and object</p>
<p>We read the entire object structure in and copy it into place</p>
<p>Check to see if it's a player</p>

</div>
</div>
<a id="a850d602c8ad86e2de86992986370a667" name="a850d602c8ad86e2de86992986370a667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a850d602c8ad86e2de86992986370a667">&#9670;&#160;</a></span>db_read_flatfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dbref db_read_flatfile </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>db_format</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>db_version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>db_flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a flatfile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
    <tr><td class="paramname">db_format</td><td>DB Format </td></tr>
    <tr><td class="paramname">db_version</td><td>DB Version </td></tr>
    <tr><td class="paramname">db_flags</td><td>DB Flags </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dbref </dd></dl>
<p>Misc tag</p>
<p>Record number of players</p>
<p>MUX and MUSH header, 2nd char selects type</p>
<p>The following things are common across 2.x, MUX, and 3.0.</p>
<p>Otherwise extract feature flags</p>
<p>More generic switch.</p>
<p>3.0 VERSION</p>
<p>2.0 VERSION</p>
<p>MUX VERSION</p>
<p>SIZE</p>
<p>USER-NAMED ATTRIBUTE</p>
<p>&lt; skip ':'</p>
<p>If not AF_ODARK, is AF_VISUAL. Strip AF_ODARK.</p>
<p>OPEN USER ATTRIBUTE SLOT</p>
<p>NEXT ATTR TO ALLOC WHEN NO FREELIST</p>
<p>MUX and MUSH entries</p>
<p>CONTENTS and EXITS</p>
<p>EXITS</p>
<p>LINK</p>
<p>NEXT</p>
<p>LOCK</p>
<p>OWNER</p>
<p>PARENT</p>
<p>PENNIES</p>
<p>FLAGS</p>
<p>ATTRIBUTES</p>
<p>check to see if it's a player</p>
<p>EOF marker</p>

</div>
</div>
<a id="ae3b2fe2b1852143ff0ee2a0140f9c05a" name="ae3b2fe2b1852143ff0ee2a0140f9c05a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b2fe2b1852143ff0ee2a0140f9c05a">&#9670;&#160;</a></span>db_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dbref db_write </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write DB to file. </p>
<dl class="section return"><dt>Returns</dt><dd>dbref </dd></dl>
<p>Lock the database</p>
<p>Write database information</p>
<p>Roll up various paramaters needed for startup into one record. This should be the only data record of its type</p>
<p>"TM3" is our unique key</p>
<p>Dump user-named attribute info</p>
<p>First, calculate the number of attribute entries we can fit in a block, allowing for some minor DBM key overhead. This should not change unless the size of VNAME_SIZE or LBUF_SIZE changes, in which case you'd have to reload anyway</p>
<p>Step through the attribute number array, writing stuff in 'num' sized chunks</p>
<p>Only write the dirty attribute numbers and clear the flag</p>
<p>No valid attributes in this block, delete it</p>
<p>Something is dirty in this block, write all of the attribute numbers in this block</p>
<p>j is an offset of attribute numbers into the current block</p>
<p>Write the block: Block number is our key</p>
<p>Dump object structures using the same block-based method we use to dump attribute numbers</p>
<p>Step through the object structure array, writing stuff in 'num' sized chunks</p>
<p>We assume you always do a dbck before dump, and Going objects are really destroyed!</p>
<p>Only write the dirty objects and clear the flag</p>
<p>No valid objects in this block, delete it</p>
<p>Something is dirty in this block, write all of the objects in this block</p>
<p>j is an offset of object numbers into the current block</p>
<p>Write the block: Block number is our key</p>
<p>Unlock the database</p>

</div>
</div>
<a id="a6d1bddbab6656f3506368a11feee62a4" name="a6d1bddbab6656f3506368a11feee62a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d1bddbab6656f3506368a11feee62a4">&#9670;&#160;</a></span>db_write_flatfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dbref db_write_flatfile </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>format</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>version</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a db to Flat File. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
    <tr><td class="paramname">format</td><td>Format of the flatfile </td></tr>
    <tr><td class="paramname">version</td><td>Version of the flatfile </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dbref </dd></dl>
<p>Attribute cleaning, if standalone.</p>
<p>Non-user defined attributes are always considered used.</p>
<p>Walk the database. Mark all the attribute numbers in use.</p>
<p>Count up how many attributes we're deleting.</p>
<p>Walk the table we've created of used statuses. When we find free slots, walk backwards to the first used slot at the end of the table. Write the number of the free slot into that used slot. Keep a mapping of what things used to be.</p>
<p>Count up our renumbers.</p>
<p>The new end of the attribute table is the first thing we've renumbered.</p>
<p>Write database information. TinyMUSH 2 wrote '+V', MUX wrote '+X', 3.0 writes '+T'.</p>
<p>Dump user-named attribute info</p>
<p>Dump object and attribute info</p>

</div>
</div>
<a id="af2d94718094444b66c24f3c841911946" name="af2d94718094444b66c24f3c841911946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2d94718094444b66c24f3c841911946">&#9670;&#160;</a></span>db_write_object_out()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_write_object_out </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dbref</td>          <td class="paramname"><span class="paramname"><em>i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int db_format </td>          <td class="paramname"><span class="paramname"><em>__attribute__</em></span>(unused), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>n_atrt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write an object to a DB. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
    <tr><td class="paramname">i</td><td>DBref of object </td></tr>
    <tr><td class="paramname">db_format</td><td>DB Format </td></tr>
    <tr><td class="paramname">flags</td><td>Flags </td></tr>
    <tr><td class="paramname">n_atrt</td><td>Number of attributes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<p>write the attribute list</p>

</div>
</div>
<a id="a0e9f096bb89fd27e023ec66aeefdfa6f" name="a0e9f096bb89fd27e023ec66aeefdfa6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9f096bb89fd27e023ec66aeefdfa6f">&#9670;&#160;</a></span>efo_convert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void efo_convert </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fix things up for Exits-From-Objects. </p>
<p>swap Exits and Link</p>

</div>
</div>
<a id="ade1ae8d0c7cc371aca3d3242ae307397" name="ade1ae8d0c7cc371aca3d3242ae307397"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade1ae8d0c7cc371aca3d3242ae307397">&#9670;&#160;</a></span>fix_mux_zones()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fix_mux_zones </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert MUX-style zones to 3.0-style zones. </p>
<p>For all objects in the database where Zone(thing) != NOTHING, set the CONTROL_OK flag on them.</p>
<p>For all objects in the database that are ZMOs (that have other objects zoned to them), copy the EnterLock of those objects to the ControlLock.</p>

</div>
</div>
<a id="a0a1ef48c56451022d41a399c71360210" name="a0a1ef48c56451022d41a399c71360210"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a1ef48c56451022d41a399c71360210">&#9670;&#160;</a></span>fix_typed_quotas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fix_typed_quotas </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explode standard quotas into typed quotas. </p>
<p>If we have a pre-2.2 or MUX database, only the QUOTA and RQUOTA attributes exist. For simplicity's sake, we assume that players will have the same quotas for all types, equal to the current value. This is going to produce incorrect values for RQUOTA; this is easily fixed by a @quota/fix done from within-game.</p>
<p>If we have a early beta 2.2 release, we have quotas which are spread out over ten attributes. We're going to have to grab those, make the new quotas, and then delete the old attributes.</p>

</div>
</div>
<a id="aba098d01bcc5234392cd6cb6fb1c972c" name="aba098d01bcc5234392cd6cb6fb1c972c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba098d01bcc5234392cd6cb6fb1c972c">&#9670;&#160;</a></span>get_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_list </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dbref</td>          <td class="paramname"><span class="paramname"><em>i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>new_strings</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read attribute list from flat file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
    <tr><td class="paramname">i</td><td>DBref </td></tr>
    <tr><td class="paramname">new_strings</td><td>New string </td></tr>
  </table>
  </dd>
</dl>
<p>read # then string</p>
<p>Store the attr</p>
<p>Silently discard</p>
<p>ignore newlines. They're due to v(r).</p>
<p>end of list</p>
<p>We've found a bad spot. I hope things aren't too bad.</p>

</div>
</div>
<a id="add7c2b24bbc4798a914920521426df5f" name="add7c2b24bbc4798a914920521426df5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add7c2b24bbc4798a914920521426df5f">&#9670;&#160;</a></span>getboolexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structboolexp.html">BOOLEXP</a> * getboolexp </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a boolean expression from the flat file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEXP* </dd></dl>
<p>parse error, we lose</p>

</div>
</div>
<a id="abc48f11473ca52157d1e8d48a6fac2e1" name="abc48f11473ca52157d1e8d48a6fac2e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc48f11473ca52157d1e8d48a6fac2e1">&#9670;&#160;</a></span>getboolexp1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structboolexp.html">BOOLEXP</a> * getboolexp1 </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get boolean subexpression from file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEXP* </dd></dl>
<p>obsolete NOTHING key, eat it</p>
<p>if last character is : then this is an attribute lock. A last character of / means an eval lock</p>
<p>dbref or attribute</p>
<p>This is either an attribute, eval, or constant lock. Constant locks are of the form &lt;num&gt;, while attribute and eval locks are of the form &lt;anam-or-anum&gt;:&lt;string&gt; or &lt;aname-or-anum&gt;/&lt;string&gt; respectively. The characters &lt;nl&gt;, |, and &amp; terminate the string.</p>
<p>Look the name up as an attribute. If not found, create a new attribute.</p>
<p>if last character is : then this is an attribute lock. A last character of / means an eval lock</p>
<p>bomb out</p>

</div>
</div>
<a id="a2e46310a02c793dea266c368b2e0c665" name="a2e46310a02c793dea266c368b2e0c665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e46310a02c793dea266c368b2e0c665">&#9670;&#160;</a></span>putbool_subexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void putbool_subexp </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structboolexp.html">BOOLEXP</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a boolean sub-expression to the flat file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
    <tr><td class="paramname">b</td><td>Boolean sub-expression </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae115b79a58100ccf65793ae2b39db2fd" name="ae115b79a58100ccf65793ae2b39db2fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae115b79a58100ccf65793ae2b39db2fd">&#9670;&#160;</a></span>putboolexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void putboolexp </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structboolexp.html">BOOLEXP</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write boolean expression to the flat file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>File </td></tr>
    <tr><td class="paramname">b</td><td>Boolean expression </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ace43463abf879b917fd2731e78fc85aa" name="ace43463abf879b917fd2731e78fc85aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace43463abf879b917fd2731e78fc85aa">&#9670;&#160;</a></span>unscramble_attrnum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int unscramble_attrnum </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>attrnum</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fix up attribute numbers from foreign muds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attrnum</td><td>attribute numbers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<p>TinyMUSH 2.2: Deal with different attribute numbers.</p>

</div>
</div>
<a id="a748779c1770afe9b83673780bf385583" name="a748779c1770afe9b83673780bf385583"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a748779c1770afe9b83673780bf385583">&#9670;&#160;</a></span>upgrade_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void upgrade_flags </td>
          <td>(</td>
          <td class="paramtype">FLAG *</td>          <td class="paramname"><span class="paramname"><em>flags1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLAG *</td>          <td class="paramname"><span class="paramname"><em>flags2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLAG *</td>          <td class="paramname"><span class="paramname"><em>flags3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dbref</td>          <td class="paramname"><span class="paramname"><em>thing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>db_format</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>db_version</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert foreign flags to MUSH format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags1</td><td>Flag </td></tr>
    <tr><td class="paramname">flags2</td><td>Flag </td></tr>
    <tr><td class="paramname">flags3</td><td>Flag </td></tr>
    <tr><td class="paramname">thing</td><td>DBref of thing </td></tr>
    <tr><td class="paramname">db_format</td><td>DB Format </td></tr>
    <tr><td class="paramname">db_version</td><td>DB Version </td></tr>
  </table>
  </dd>
</dl>
<p>TinyMUSH 2.2 to 3.0 flag conversion</p>
<p>This is the unimplemented TICKLER flag.</p>
<p>TinyMUX to 3.0 flag conversion</p>
<p>This used to be an object set NO_COMMAND. We unset the flag.</p>
<p>And if it wasn't NO_COMMAND, then it should be COMMANDS.</p>
<p>This used to be the COMPRESS flag, which didn't do anything.</p>
<p>Players set MONITOR should be set WATCHER as well.</p>
<p>Native TinyMUSH 3.0 database. The only thing we have to do is clear the redirection flag, as nothing is ever redirected at startup.</p>
<p>&lt; this flag is now obsolete</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a81abf5d67af4cc116d290a1d21c750d4" name="a81abf5d67af4cc116d290a1d21c750d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81abf5d67af4cc116d290a1d21c750d4">&#9670;&#160;</a></span>db</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structobject.html">object</a>* db</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>struct database </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
