<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TinyMUSH: Skeleton Module - Complete Template for TinyMUSH Modules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TinyMUSH<span id="projectnumber">&#160;3.3</span>
   </div>
   <div id="projectbrief">TinyMUSH Server</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Skeleton Module - Complete Template for TinyMUSH Modules</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md522"></a></p>
<p>This skeleton is a working TinyMUSH module that shows the minimal but complete pattern: version metadata, configuration table, command table, function table, hash table usage, init/cleanup, and simple handlers.</p>
<h1><a class="anchor" id="autotoc_md523"></a>
Quick Start (5 minutes)</h1>
<div class="fragment"><div class="line"># Copy skeleton as your new module</div>
<div class="line">cp -r src/modules/skeleton src/modules/mymodule</div>
<div class="line">cd src/modules/mymodule</div>
<div class="line"> </div>
<div class="line"># Rename files</div>
<div class="line">mv skeleton.h mymodule.h</div>
<div class="line">mv skeleton.c mymodule.c</div>
<div class="line"> </div>
<div class="line"># Replace all occurrences</div>
<div class="line">sed -i &#39;s/skeleton/mymodule/g&#39; mymodule.h mymodule.c CMakeLists.txt</div>
<div class="line"> </div>
<div class="line"># Build</div>
<div class="line">cd /home/eddy/source/TinyMUSH</div>
<div class="line">rm -rf build &amp;&amp; mkdir build &amp;&amp; cd build</div>
<div class="line">cmake .. &amp;&amp; make</div>
<div class="line"> </div>
<div class="line"># Configure (add to game/configs/netmush.conf)</div>
<div class="line">module mymodule</div>
<div class="line">mymodule_enabled yes</div>
<div class="line"> </div>
<div class="line"># Restart</div>
<div class="line">cd ../game &amp;&amp; ./netmush -D</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md524"></a>
File Structure</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">File   </th><th class="markdownTableHeadNone">Purpose   </th><th class="markdownTableHeadNone">Lines    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="skeleton_8h.html" title="Skeleton module header - use as template for new modules.">skeleton.h</a></code>   </td><td class="markdownTableBodyNone">Declarations, config struct, prototypes   </td><td class="markdownTableBodyNone">~45    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="skeleton_8c.html" title="Skeleton module - complete template for new modules.">skeleton.c</a></code>   </td><td class="markdownTableBodyNone">Implementation with comments   </td><td class="markdownTableBodyNone">~200    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>CMakeLists.txt</code>   </td><td class="markdownTableBodyNone">Minimal CMake build (4 lines)   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>README.md</code>   </td><td class="markdownTableBodyNone">This guide   </td><td class="markdownTableBodyNone">~160    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>QUICK_REFERENCE.md</code>   </td><td class="markdownTableBodyNone">Cheat sheet   </td><td class="markdownTableBodyNone">~150   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md525"></a>
Core Concepts</h1>
<h2><a class="anchor" id="autotoc_md526"></a>
1. Module Initialization (REQUIRED)</h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="skeleton_8c.html#a0cc28d02ce83a0fe6bb273b2d90e6282">mod_skeleton_init</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Defaults */</span></div>
<div class="line">    <a class="code hl_variable" href="skeleton_8c.html#aae4eef9a8a40d8f00d79ac9dfd143c49">mod_skeleton_config</a>.enabled = 1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Hash table */</span></div>
<div class="line">    hashinit(&amp;<a class="code hl_variable" href="skeleton_8c.html#ab3fca4618a027fc1d6f7ab42d1c75d74">mod_skeleton_data_htab</a>, 100, <a class="code hl_define" href="constants_8h.html#a1056b6e6b9cb73a581fe3ba3e3ca3548">HT_KEYREF</a> | <a class="code hl_define" href="constants_8h.html#afb416e2446a6769c9c843925dd553eef">HT_STR</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Register tables */</span></div>
<div class="line">    <a class="code hl_function" href="api_8c.html#ae5bb1b336c21c7e64ea8c77141ef7673">register_commands</a>(mod_skeleton_cmdtable);</div>
<div class="line">    <a class="code hl_function" href="api_8c.html#a3e28939ab772d85f2ce15d7499908871">register_functions</a>(mod_skeleton_functable);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="macros_8h.html#adba1624513b5ccddfc8bc0831f9cbf45">log_write</a>(<a class="code hl_define" href="constants_8h.html#a70f52cf948e57d4338de17a52f8e1a0a">LOG_ALWAYS</a>, <span class="stringliteral">&quot;MOD&quot;</span>, <span class="stringliteral">&quot;SKEL&quot;</span>, <span class="stringliteral">&quot;Module SKELETON initialized&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="aapi_8c_html_a3e28939ab772d85f2ce15d7499908871"><div class="ttname"><a href="api_8c.html#a3e28939ab772d85f2ce15d7499908871">register_functions</a></div><div class="ttdeci">void register_functions(FUN *functab)</div><div class="ttdoc">Register module's functions with the main functions handler.</div><div class="ttdef"><b>Definition</b> api.c:147</div></div>
<div class="ttc" id="aapi_8c_html_ae5bb1b336c21c7e64ea8c77141ef7673"><div class="ttname"><a href="api_8c.html#ae5bb1b336c21c7e64ea8c77141ef7673">register_commands</a></div><div class="ttdeci">void register_commands(CMDENT *cmdtab)</div><div class="ttdoc">Register module's commands with the main command handler.</div><div class="ttdef"><b>Definition</b> api.c:104</div></div>
<div class="ttc" id="aconstants_8h_html_a1056b6e6b9cb73a581fe3ba3e3ca3548"><div class="ttname"><a href="constants_8h.html#a1056b6e6b9cb73a581fe3ba3e3ca3548">HT_KEYREF</a></div><div class="ttdeci">#define HT_KEYREF</div><div class="ttdef"><b>Definition</b> constants.h:1350</div></div>
<div class="ttc" id="aconstants_8h_html_a70f52cf948e57d4338de17a52f8e1a0a"><div class="ttname"><a href="constants_8h.html#a70f52cf948e57d4338de17a52f8e1a0a">LOG_ALWAYS</a></div><div class="ttdeci">#define LOG_ALWAYS</div><div class="ttdef"><b>Definition</b> constants.h:1469</div></div>
<div class="ttc" id="aconstants_8h_html_afb416e2446a6769c9c843925dd553eef"><div class="ttname"><a href="constants_8h.html#afb416e2446a6769c9c843925dd553eef">HT_STR</a></div><div class="ttdeci">#define HT_STR</div><div class="ttdef"><b>Definition</b> constants.h:1347</div></div>
<div class="ttc" id="amacros_8h_html_adba1624513b5ccddfc8bc0831f9cbf45"><div class="ttname"><a href="macros_8h.html#adba1624513b5ccddfc8bc0831f9cbf45">log_write</a></div><div class="ttdeci">#define log_write(i, p, s, f,...)</div><div class="ttdoc">Log related macros.</div><div class="ttdef"><b>Definition</b> macros.h:220</div></div>
<div class="ttc" id="askeleton_8c_html_a0cc28d02ce83a0fe6bb273b2d90e6282"><div class="ttname"><a href="skeleton_8c.html#a0cc28d02ce83a0fe6bb273b2d90e6282">mod_skeleton_init</a></div><div class="ttdeci">void mod_skeleton_init(void)</div><div class="ttdef"><b>Definition</b> skeleton.c:204</div></div>
<div class="ttc" id="askeleton_8c_html_aae4eef9a8a40d8f00d79ac9dfd143c49"><div class="ttname"><a href="skeleton_8c.html#aae4eef9a8a40d8f00d79ac9dfd143c49">mod_skeleton_config</a></div><div class="ttdeci">struct mod_skeleton_confstorage mod_skeleton_config</div><div class="ttdef"><b>Definition</b> skeleton.c:56</div></div>
<div class="ttc" id="askeleton_8c_html_ab3fca4618a027fc1d6f7ab42d1c75d74"><div class="ttname"><a href="skeleton_8c.html#ab3fca4618a027fc1d6f7ab42d1c75d74">mod_skeleton_data_htab</a></div><div class="ttdeci">HASHTAB mod_skeleton_data_htab</div><div class="ttdef"><b>Definition</b> skeleton.c:62</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md527"></a>
2. Configuration (netmush.conf)</h2>
<div class="fragment"><div class="line">module skeleton</div>
<div class="line">skeleton_enabled yes</div>
</div><!-- fragment --><p>CONF table (in <a class="el" href="skeleton_8c.html" title="Skeleton module - complete template for new modules.">skeleton.c</a>):</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structconfparm.html">CONF</a> <a class="code hl_variable" href="skeleton_8c.html#ad0443ebf2b26285bf93fb4b0d01750a9">mod_skeleton_conftable</a>[] = {</div>
<div class="line">    {(<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;skeleton_enabled&quot;</span>, <a class="code hl_function" href="conf_8c.html#a3637eed82e0dc8a7aca3d536208a691a">cf_bool</a>, <a class="code hl_define" href="constants_8h.html#ae3711c84b4ca88296796e8af4df161e2">CA_GOD</a>, <a class="code hl_define" href="constants_8h.html#ac83d7116eca40585f086d0c0c5e02e0c">CA_PUBLIC</a>,</div>
<div class="line">     &amp;<a class="code hl_variable" href="skeleton_8c.html#aae4eef9a8a40d8f00d79ac9dfd143c49">mod_skeleton_config</a>.enabled, (<span class="keywordtype">long</span>)<span class="stringliteral">&quot;Enable skeleton module&quot;</span>},</div>
<div class="line">    {NULL, NULL, 0, 0, NULL, 0}</div>
<div class="line">};</div>
<div class="ttc" id="aconf_8c_html_a3637eed82e0dc8a7aca3d536208a691a"><div class="ttname"><a href="conf_8c.html#a3637eed82e0dc8a7aca3d536208a691a">cf_bool</a></div><div class="ttdeci">CF_Result cf_bool(int *vp, char *str, long extra __attribute__((unused)), dbref player __attribute__((unused)), char *cmd __attribute__((unused)))</div><div class="ttdoc">Set boolean parameter.</div><div class="ttdef"><b>Definition</b> conf.c:785</div></div>
<div class="ttc" id="aconstants_8h_html_ac83d7116eca40585f086d0c0c5e02e0c"><div class="ttname"><a href="constants_8h.html#ac83d7116eca40585f086d0c0c5e02e0c">CA_PUBLIC</a></div><div class="ttdeci">#define CA_PUBLIC</div><div class="ttdoc">Command permission flags.</div><div class="ttdef"><b>Definition</b> constants.h:379</div></div>
<div class="ttc" id="aconstants_8h_html_ae3711c84b4ca88296796e8af4df161e2"><div class="ttname"><a href="constants_8h.html#ae3711c84b4ca88296796e8af4df161e2">CA_GOD</a></div><div class="ttdeci">#define CA_GOD</div><div class="ttdef"><b>Definition</b> constants.h:380</div></div>
<div class="ttc" id="askeleton_8c_html_ad0443ebf2b26285bf93fb4b0d01750a9"><div class="ttname"><a href="skeleton_8c.html#ad0443ebf2b26285bf93fb4b0d01750a9">mod_skeleton_conftable</a></div><div class="ttdeci">CONF mod_skeleton_conftable[]</div><div class="ttdef"><b>Definition</b> skeleton.c:89</div></div>
<div class="ttc" id="astructconfparm_html"><div class="ttname"><a href="structconfparm.html">confparm</a></div><div class="ttdef"><b>Definition</b> typedefs.h:775</div></div>
</div><!-- fragment --><p>Types used: <code>cf_bool</code>; Perms: <code>CA_GOD</code>, <code>CA_PUBLIC</code>.</p>
<h2><a class="anchor" id="autotoc_md528"></a>
3. Commands</h2>
<p>Executed by players, can notify feedback:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="skeleton_8c.html#a43c9cb1608fda8b8f1181f6ff22502b6">mod_do_skeleton_command</a>(dbref player, dbref cause, <span class="keywordtype">int</span> key, <span class="keywordtype">char</span> *arg1)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="skeleton_8c.html#aae4eef9a8a40d8f00d79ac9dfd143c49">mod_skeleton_config</a>.enabled)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="macros_8h.html#abe044d79896c3d56e758f742f4765f61">notify</a>(player, <span class="stringliteral">&quot;The skeleton module is not enabled.&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!arg1 || !*arg1)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="macros_8h.html#abe044d79896c3d56e758f742f4765f61">notify</a>(player, <span class="stringliteral">&quot;Usage: skeleton &lt;message&gt;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    notify_check(player, player, <a class="code hl_define" href="constants_8h.html#aa3a8005ada88b76cc20209b5661139d9">MSG_PUP_ALWAYS</a> | <a class="code hl_define" href="constants_8h.html#a1092ba11753fe151e7779395a7665ca3">MSG_ME</a>, <span class="stringliteral">&quot;Skeleton says: %s&quot;</span>, arg1);</div>
<div class="line">    <a class="code hl_define" href="macros_8h.html#adba1624513b5ccddfc8bc0831f9cbf45">log_write</a>(<a class="code hl_define" href="constants_8h.html#a70f52cf948e57d4338de17a52f8e1a0a">LOG_ALWAYS</a>, <span class="stringliteral">&quot;MOD&quot;</span>, <span class="stringliteral">&quot;SKEL&quot;</span>, <span class="stringliteral">&quot;Command received from %s: %s&quot;</span>, <a class="code hl_function" href="db__objects_8c.html#ad0d9086dc6e11c897a0e93db0fb0b280">Name</a>(player), arg1);</div>
<div class="line">}</div>
<div class="ttc" id="aconstants_8h_html_a1092ba11753fe151e7779395a7665ca3"><div class="ttname"><a href="constants_8h.html#a1092ba11753fe151e7779395a7665ca3">MSG_ME</a></div><div class="ttdeci">#define MSG_ME</div><div class="ttdef"><b>Definition</b> constants.h:798</div></div>
<div class="ttc" id="aconstants_8h_html_aa3a8005ada88b76cc20209b5661139d9"><div class="ttname"><a href="constants_8h.html#aa3a8005ada88b76cc20209b5661139d9">MSG_PUP_ALWAYS</a></div><div class="ttdeci">#define MSG_PUP_ALWAYS</div><div class="ttdef"><b>Definition</b> constants.h:787</div></div>
<div class="ttc" id="adb__objects_8c_html_ad0d9086dc6e11c897a0e93db0fb0b280"><div class="ttname"><a href="db__objects_8c.html#ad0d9086dc6e11c897a0e93db0fb0b280">Name</a></div><div class="ttdeci">char * Name(dbref thing)</div><div class="ttdoc">Get the name of a thing.</div><div class="ttdef"><b>Definition</b> db_objects.c:90</div></div>
<div class="ttc" id="amacros_8h_html_abe044d79896c3d56e758f742f4765f61"><div class="ttname"><a href="macros_8h.html#abe044d79896c3d56e758f742f4765f61">notify</a></div><div class="ttdeci">#define notify(p, m,...)</div><div class="ttdef"><b>Definition</b> macros.h:226</div></div>
<div class="ttc" id="askeleton_8c_html_a43c9cb1608fda8b8f1181f6ff22502b6"><div class="ttname"><a href="skeleton_8c.html#a43c9cb1608fda8b8f1181f6ff22502b6">mod_do_skeleton_command</a></div><div class="ttdeci">void mod_do_skeleton_command(dbref player, dbref cause, int key, char *arg1)</div><div class="ttdef"><b>Definition</b> skeleton.c:128</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md529"></a>
4. Functions</h2>
<p>Called from softcode, return values via result buffer:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="skeleton_8c.html#aa8b3921d5c32918b378238c7af3abf4a">mod_do_skeleton_function</a>(<span class="keywordtype">char</span> *buff, <span class="keywordtype">char</span> **bufc, dbref player, dbref caller, dbref cause, <span class="keywordtype">char</span> *fargs[], <span class="keywordtype">int</span> nfargs, <span class="keywordtype">char</span> *cargs[], <span class="keywordtype">int</span> ncargs)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="skeleton_8c.html#aae4eef9a8a40d8f00d79ac9dfd143c49">mod_skeleton_config</a>.enabled)</div>
<div class="line">    {</div>
<div class="line">        XSAFELBSTR(<span class="stringliteral">&quot;#-1 SKELETON DISABLED&quot;</span>, buff, bufc);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    XSAFESPRINTF(buff, bufc, <span class="stringliteral">&quot;dbref: #%d, caller #%d, nfargs: %d, ncargs: %d&quot;</span>, player, caller, nfargs, ncargs);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nfargs &gt; 0)</div>
<div class="line">    {</div>
<div class="line">        XSAFELBSTR(<span class="stringliteral">&quot;, fargs:&quot;</span>, buff, bufc);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; nfargs; i++)</div>
<div class="line">        {</div>
<div class="line">            XSAFELBCHR(<span class="charliteral">&#39; &#39;</span>, buff, bufc);</div>
<div class="line">            XSAFELBSTR(fargs[i], buff, bufc);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ncargs &gt; 0)</div>
<div class="line">    {</div>
<div class="line">        XSAFELBSTR(<span class="stringliteral">&quot;, cargs:&quot;</span>, buff, bufc);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; ncargs; i++)</div>
<div class="line">        {</div>
<div class="line">            XSAFELBCHR(<span class="charliteral">&#39; &#39;</span>, buff, bufc);</div>
<div class="line">            XSAFELBSTR(cargs[i], buff, bufc);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="macros_8h.html#adba1624513b5ccddfc8bc0831f9cbf45">log_write</a>(<a class="code hl_define" href="constants_8h.html#a70f52cf948e57d4338de17a52f8e1a0a">LOG_ALWAYS</a>, <span class="stringliteral">&quot;MOD&quot;</span>, <span class="stringliteral">&quot;SKEL&quot;</span>, <span class="stringliteral">&quot;dbref: #%d, caller #%d, nfargs: %d, ncargs: %d&quot;</span>, player, caller, nfargs, ncargs);</div>
<div class="line">}</div>
<div class="ttc" id="askeleton_8c_html_aa8b3921d5c32918b378238c7af3abf4a"><div class="ttname"><a href="skeleton_8c.html#aa8b3921d5c32918b378238c7af3abf4a">mod_do_skeleton_function</a></div><div class="ttdeci">void mod_do_skeleton_function(char *buff, char **bufc, dbref player, dbref caller, dbref cause, char *fargs[], int nfargs, char *cargs[], int ncargs)</div><div class="ttdef"><b>Definition</b> skeleton.c:156</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md530"></a>
5. Hash Tables</h2>
<p>Store and retrieve data efficiently (integer data for the example):</p>
<div class="fragment"><div class="line"><span class="comment">// Initialize (in mod_skeleton_init)</span></div>
<div class="line">hashinit(&amp;<a class="code hl_variable" href="skeleton_8c.html#ab3fca4618a027fc1d6f7ab42d1c75d74">mod_skeleton_data_htab</a>, 100);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use helper functions (all provided in skeleton)</span></div>
<div class="line"><a class="code hl_function" href="skeleton_8c.html#abcacc6885c863fe01915f3ba1ad947e2">mod_skeleton_set_data</a>(<span class="stringliteral">&quot;key&quot;</span>, data_ptr);</div>
<div class="line"><span class="keywordtype">int</span> *data = <a class="code hl_function" href="skeleton_8c.html#adb46c6f46d960ea546296d7843c7abb9">mod_skeleton_get_data</a>(<span class="stringliteral">&quot;key&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="skeleton_8c.html#ade97ecb74c394c043a669b07e18a5360">mod_skeleton_delete_data</a>(<span class="stringliteral">&quot;key&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="skeleton_8c.html#ac206f4681ab2a5fe6d4c6f5b56155af1">mod_skeleton_list_data</a>(player);  <span class="comment">// Show all entries</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Or use API directly</span></div>
<div class="line">hashadd(<span class="stringliteral">&quot;key&quot;</span>, data, &amp;<a class="code hl_variable" href="skeleton_8c.html#ab3fca4618a027fc1d6f7ab42d1c75d74">mod_skeleton_data_htab</a>, <span class="stringliteral">&quot;func&quot;</span>);</div>
<div class="line"><span class="keywordtype">void</span> *x = hashfind(<span class="stringliteral">&quot;key&quot;</span>, &amp;<a class="code hl_variable" href="skeleton_8c.html#ab3fca4618a027fc1d6f7ab42d1c75d74">mod_skeleton_data_htab</a>);</div>
<div class="line">hashdelete(<span class="stringliteral">&quot;key&quot;</span>, &amp;<a class="code hl_variable" href="skeleton_8c.html#ab3fca4618a027fc1d6f7ab42d1c75d74">mod_skeleton_data_htab</a>);</div>
<div class="ttc" id="askeleton_8c_html_abcacc6885c863fe01915f3ba1ad947e2"><div class="ttname"><a href="skeleton_8c.html#abcacc6885c863fe01915f3ba1ad947e2">mod_skeleton_set_data</a></div><div class="ttdeci">CF_Result mod_skeleton_set_data(char *key, int *data)</div><div class="ttdef"><b>Definition</b> skeleton.c:241</div></div>
<div class="ttc" id="askeleton_8c_html_ac206f4681ab2a5fe6d4c6f5b56155af1"><div class="ttname"><a href="skeleton_8c.html#ac206f4681ab2a5fe6d4c6f5b56155af1">mod_skeleton_list_data</a></div><div class="ttdeci">void mod_skeleton_list_data(dbref player)</div><div class="ttdef"><b>Definition</b> skeleton.c:267</div></div>
<div class="ttc" id="askeleton_8c_html_adb46c6f46d960ea546296d7843c7abb9"><div class="ttname"><a href="skeleton_8c.html#adb46c6f46d960ea546296d7843c7abb9">mod_skeleton_get_data</a></div><div class="ttdeci">int * mod_skeleton_get_data(char *key)</div><div class="ttdef"><b>Definition</b> skeleton.c:229</div></div>
<div class="ttc" id="askeleton_8c_html_ade97ecb74c394c043a669b07e18a5360"><div class="ttname"><a href="skeleton_8c.html#ade97ecb74c394c043a669b07e18a5360">mod_skeleton_delete_data</a></div><div class="ttdeci">bool mod_skeleton_delete_data(char *key)</div><div class="ttdef"><b>Definition</b> skeleton.c:253</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md531"></a>
Helper Functions Provided</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>mod_skeleton_get_data(key)</code>   </td><td class="markdownTableBodyNone">Get from hash table (int*)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>mod_skeleton_set_data(key, int *)</code>   </td><td class="markdownTableBodyNone">Store in hash table    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>mod_skeleton_delete_data(key)</code>   </td><td class="markdownTableBodyNone">Delete from hash table    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>mod_skeleton_list_data(player)</code>   </td><td class="markdownTableBodyNone">Count/print entries    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="skeleton_8c.html#aee64d5e16ddad7ed5a8cfa333da7b093">mod_skeleton_reset_defaults()</a></code>   </td><td class="markdownTableBodyNone">Reset config to defaults    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="skeleton_8c.html#a9147d4aa44f95b9ec96c752ce1704fea">mod_skeleton_cleanup()</a></code>   </td><td class="markdownTableBodyNone">Clean up on module unload   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md532"></a>
Safe String Operations</h1>
<p>Always use safe functions - never use raw <code>strcpy</code>/<code>strcat</code>/<code>sprintf</code>:</p>
<div class="fragment"><div class="line"><span class="comment">// SAFE - All of these are safe</span></div>
<div class="line">XSAFESTRNCPY(dest, src, dest, <span class="keyword">sizeof</span>(dest), <span class="stringliteral">&quot;func&quot;</span>);</div>
<div class="line">xstrncpy(dest, src, <span class="keyword">sizeof</span>(dest));</div>
<div class="line">XSAFESTRCAT(dest, src, dest, <span class="keyword">sizeof</span>(dest), <span class="stringliteral">&quot;func&quot;</span>);</div>
<div class="line"><span class="comment">/* Use XSAFE helpers; log_write handles formatting safely */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// UNSAFE - NEVER USE</span></div>
<div class="line">strcpy(dest, src);              <span class="comment">// BUFFER OVERFLOW!</span></div>
<div class="line">strcat(dest, src);              <span class="comment">// BUFFER OVERFLOW!</span></div>
<div class="line">sprintf(dest, <span class="stringliteral">&quot;%s&quot;</span>, src);       <span class="comment">// BUFFER OVERFLOW!</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md533"></a>
Memory Management</h1>
<p>Track all allocations and deallocate in cleanup:</p>
<div class="fragment"><div class="line"><span class="comment">// Allocate</span></div>
<div class="line"><span class="keywordtype">void</span> *ptr = <a class="code hl_define" href="macros_8h.html#a1f2dc397904297d0a9ba598093b19976">XMALLOC</a>(size, <span class="stringliteral">&quot;function&quot;</span>);</div>
<div class="line"><span class="keywordtype">char</span> *str = XSTRDUP(<span class="stringliteral">&quot;text&quot;</span>, <span class="stringliteral">&quot;function&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Must deallocate (same tag)</span></div>
<div class="line">XFREE(ptr, <span class="stringliteral">&quot;function&quot;</span>);</div>
<div class="line">XFREE(str, <span class="stringliteral">&quot;function&quot;</span>);</div>
<div class="ttc" id="amacros_8h_html_a1f2dc397904297d0a9ba598093b19976"><div class="ttname"><a href="macros_8h.html#a1f2dc397904297d0a9ba598093b19976">XMALLOC</a></div><div class="ttdeci">#define XMALLOC(s, v)</div><div class="ttdoc">XMALLOC related macros.</div><div class="ttdef"><b>Definition</b> macros.h:21</div></div>
</div><!-- fragment --><p>The <code><a class="el" href="skeleton_8c.html#a9147d4aa44f95b9ec96c752ce1704fea">mod_skeleton_cleanup()</a></code> function shows the pattern for proper cleanup.</p>
<h1><a class="anchor" id="autotoc_md534"></a>
Customization Steps</h1>
<ol type="1">
<li><b>Rename module</b> - Change <code>skeleton</code> → <code>mymodule</code> everywhere</li>
<li><b>Update version</b> - Edit <code>MODVER</code> in mymodule.c</li>
<li><b>Update config struct</b> - Add fields to struct in mymodule.h</li>
<li><b>Update CONF table</b> - Map config directives in mymodule.c</li>
<li><b>Implement logic</b> - Replace command/function bodies</li>
<li><b>Register handlers</b> - Call <code>register_command()</code> and <code>register_function()</code> in init</li>
<li><b>Build</b> - <code>cmake .. &amp;&amp; make</code></li>
<li><b>Test</b> - Check logs and try in-game</li>
</ol>
<h1><a class="anchor" id="autotoc_md535"></a>
Testing</h1>
<div class="fragment"><div class="line"># In-game (after loading)</div>
<div class="line">@version               # Check it loads</div>
<div class="line">@skeleton test         # Try command</div>
<div class="line">think skeleton(1,2,3)  # Try function</div>
<div class="line"> </div>
<div class="line"># Check logs</div>
<div class="line">tail -f game/logs/netmush.log | grep skeleton</div>
<div class="line"> </div>
<div class="line"># Enable debug output</div>
<div class="line">netmush.conf: skeleton_debug 2</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md536"></a>
Common Issues</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Problem   </th><th class="markdownTableHeadNone">Solution    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Module not loading   </td><td class="markdownTableBodyNone">Check <code>module mymodule</code> in netmush.conf    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Command not found   </td><td class="markdownTableBodyNone">Verify <code>register_command()</code> in init    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Crash on hash lookup   </td><td class="markdownTableBodyNone">Ensure <code>hashinit()</code> called in init    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Config not applying   </td><td class="markdownTableBodyNone">Check CONF table spelling and type    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Memory leaks   </td><td class="markdownTableBodyNone">Match <code>XMALLOC</code> with <code>XFREE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Buffer overflow   </td><td class="markdownTableBodyNone">Never use <code>strcpy</code>, use <code>xstrncpy</code>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md537"></a>
Development Checklist</h1>
<ul class="check">
<li class="unchecked">Module renamed in all files</li>
</ul>
<ul class="check">
<li class="unchecked">MODVER updated</li>
</ul>
<ul class="check">
<li class="unchecked">Config struct populated</li>
</ul>
<ul class="check">
<li class="unchecked">CONF table entries added</li>
</ul>
<ul class="check">
<li class="unchecked">Commands/functions implemented</li>
</ul>
<ul class="check">
<li class="unchecked">Registrations in init</li>
</ul>
<ul class="check">
<li class="unchecked">Builds cleanly (<code>cmake .. &amp;&amp; make</code>)</li>
</ul>
<ul class="check">
<li class="unchecked">Loads without errors (check logs)</li>
</ul>
<ul class="check">
<li class="unchecked">Commands/functions work in-game</li>
</ul>
<ul class="check">
<li class="unchecked">Cleanup function updated</li>
</ul>
<h1><a class="anchor" id="autotoc_md538"></a>
Reference</h1>
<ul>
<li><b>Quick patterns:</b> See <code>QUICK_REFERENCE.md</code></li>
<li><b>Full API docs:</b> <code>docs/MODULES_DEVELOPMENT.md</code></li>
<li><b>Example modules:</b> <code>src/modules/mail/</code>, <code>src/modules/comsys/</code></li>
<li><b>Header files:</b> <code>src/netmush/*.h</code></li>
</ul>
<p><b>⭐ Start with QUICK_REFERENCE.md for common code patterns!</b> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
