<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TinyMUSH: &lt;center&gt;WARNING&lt;br&gt;&lt;br&gt;THIS FILE IS OUTDATED AND WILL BE UPDATED IN THE FUTURE&lt;/center&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TinyMUSH<span id="projectnumber">&#160;3.3</span>
   </div>
   <div id="projectbrief">TinyMUSH Server</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title"><center>WARNING&lt;br&gt;<br  />
THIS FILE IS OUTDATED AND WILL BE UPDATED IN THE FUTURE</center> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md53"></a>
Frequently-Asked Questions</h1>
<ul>
<li>I found a bug! What do I do?</li>
<li>How do I make a new configuration file?</li>
<li>How do I back up my database?</li>
<li>How do I restore a database backup?</li>
<li>How do I apply a patch upgrade or bugfix?</li>
<li>How do I recover a lost password for God (#1)?</li>
<li>How do logfiles work?</li>
<li>How do I use multiple guests?</li>
<li>How do I create my own flags? (How do I configure marker flags?) = How can I create "altered reality" realm states like invisibility?</li>
<li>How do I tune the database cache?</li>
<li>How do I use an in-memory database?</li>
<li>Help! I'm having database problems.</li>
<li>How do I set up a link to an external SQL database?</li>
</ul>
<h2><a class="anchor" id="autotoc_md54"></a>
I found a bug! What do I do?</h2>
<ul>
<li>Make sure that it really is a bug, and not a new feature or design decision. If it crashes the server, it's a bug. If you can't tell, consider it a bug.</li>
<li>Try to come up with an easily-reproducible sequence of events that will demonstrate the bug.</li>
<li>Visit <a href="https://github.com/TinyMUSH/TinyMUSH/issues">https://github.com/TinyMUSH/TinyMUSH/issues</a> and fill a bug report.</li>
<li><p class="startli">If the bug crashes the server, we really, really, want to hear about it. We'd like as much information as possible.</p>
<p class="startli">We've included a script which automatically analyzes core files and emails results to us. Go to your game directory, and type './ReportCrash' You should eventually see a 'Done.' &ndash; that means the analysis was successful. If you get an error message and early end to the script, you'll need to deal with it manually.</p>
<p class="startli">The following sequence of commands will generate a stack trace and variable dumps from the core file. Cut-and-paste the output and email it along with your bug report. You can obtain this by doing the following from the game directory:</p>
<p class="startli">gdb bin/netmush core where info frame info args info locals up info args info locals up (Repeat until you're at the top procedure level.) quit</p>
<p class="startli">If you don't have gdb, use dbx, as follows:</p>
<p class="startli">dbx bin/netmush core where dump up dump up (Repeat until you're at the top procedure level.) quit</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md55"></a>
How do I make a new configuration file?</h2>
<p >TinyMUSH 3 gets the information it needs to operate the game (aside from the database itself) from a configuration file that is read in at startup. The configuration file contains various parameters, such as where to find the database, what port to listen for connects, and many other things.</p>
<p >Follow these instructions to make a configuration file for your MUSH from the supplied template configuration file:</p>
<p >In your game directory, copy the file netmush.conf to &lt;your-mud-name&gt;.conf and edit it as follows: </p><pre class="fragment">- Replace netmush.&lt;whatever&gt; in the 'xxx_database' lines with
  &lt;your-mud-name&gt;.&lt;whatever&gt;.

- Set the port number on the 'port' line to the correct port.

- Set the mud name on the 'mud_name' line to the name of your mud.

- Make any other configuration changes you want to make at this time.
  Here are some of the common ones to change:
     o money_name_singular &lt;text&gt;  The name of one coin (penny)
     o money_name_plural &lt;text&gt;    The name of several coins (pennies)
     o fork_dump no           Do this if you have little swap space.
     o paycheck &lt;amount&gt;      Players get this much money each day
                              they connect.
     o paystart &lt;amount&gt;      Players start out with this much money.
     o payfind &lt;chance&gt;       Each time a player moves, he has a
                              1 in &lt;chance&gt; chance of finding a penny.
     o player_starting_room &lt;roomno&gt;  The room that new players are
                              created in.
</pre><p> There are many more configuration directives available. Information on individual directives can be obtained with the WIZHELP &lt;directive&gt; command within the MUSH.</p>
<h2><a class="anchor" id="autotoc_md56"></a>
How do I back up my database?</h2>
<p >Shut down your game. Go into the game directory, and type './Backup' This will create a 'flatfile', and compress it with GNU zip; if there's no GNU zip on your system, you should edit the Backup script so it uses Unix compress instead.</p>
<p >If you want to back up your database while the game is running, use @dump/flatfile; this is a strong candidate for a @daily on your God character.</p>
<p >If for some reason, you can't run a backup from within the game (you've forgotten your passwords to the wizard characters, or something similarly problematic), and you can't or don't want to shut the game down, you can safely back up the database with Backup while the game is running, but you are not guaranteed 100% consistency within the flatfile. You can minimize consistency errors by doing a @dump, waiting a minute until the database is done saving, and then do the Backup; even if there are slight out-of-sync errors (due to changed attributes not yet being written to disk) they will not prevent the backup from being restorable. If the game is running, @dump/flatfile is strongly preferable, since the resulting flatfile will contain the most current, in-sync data.</p>
<p >Do NOT simply naively copy around netmush.db, netmush.gdbm, etc., as they are not portable between platforms. Use the Backup script to create flatfiles.</p>
<p >Note that this does NOT back up your comsys database or mail database, or other relevant MUSH files. You can simply copy comsys.db and mail.db to a safe place, to back them up. Alternatively, you can run the Archive script to back up all the important files.</p>
<h2><a class="anchor" id="autotoc_md57"></a>
How do I restore a database backup?</h2>
<p >Shut down the game (if it's currently running). Then, go into the game directory and type './Restore name-of-flatfile', where name-of-flatfile is the name of your backup file.</p>
<p >Note that this only restores your database; it does not restore the comsys or mail databases. To restore the latter, simply copy your saved copies of comsys.db and mail.db back to the game directory.</p>
<h2><a class="anchor" id="autotoc_md58"></a>
How do I apply a patch upgrade or bugfix?</h2>
<p >The easiest way to patch the server, if you have perl installed on your system, is to type './Update' &ndash; this will automatically download patches, apply them, and clean up. You will then be given instructions as to what to do to build the new version of the server, which you should follow unless some other instructions were specifically given with the changes (check BETA, CHANGES, and INSTALL, for instance).</p>
<p >To patch the server manually:</p>
<ul>
<li>Download the patch from the archive, via FTP or the Web. Save the file in your code directory, which is probably called something like 'tinymush-3.0' &ndash; it's the same directory that contains this FAQ file.</li>
<li>Type: gzcat name_of_patchfile.gz | patch -p1 name_of_patchfile will probably be something like 'patch-30p1-30p2' (with a .gz extension). If you do not have gzcat, type 'gunzip name_of_patchfile.gz' and then 'patch -p1 &lt; name_of_patchfile' If you do not have the 'patch' program on your system, you cannot apply patches. Get your system administrator to install it.</li>
<li>If you have previously compiled TinyMUSH in this directory, you need to make sure that a clean build of the patched version is done, so type: cd src make clean cd ..</li>
<li>Type: ./Build</li>
</ul>
<p >If there are problems with the patch, make sure that nothing strange has happened &ndash; for example, there are no carriage-return/newlines ('^M') characters at the end of lines.</p>
<p >Also, if you're applying multiple patches, make sure to do them in chronological sequence &ndash; oldest to newest patch.</p>
<h2><a class="anchor" id="autotoc_md59"></a>
How do I recover a lost password for God (#1)?</h2>
<p >You will need to recompile the server with a new God character, use it to change the password of the old God character, and then recompile again. To do this, do the following:</p>
<ul>
<li>Log into a character whose password you know; this will normally be a wizard character.</li>
<li>Find out the dbref of that character ('think num(me)' will tell you).</li>
<li>Shut down the MUSH.</li>
<li>Edit src/flags.h and find the line that reads '#define GOD ((dbref) 1)'. Replace the '1' with the dbref number of the character (i.e., if the number is #1234, then use 1234).</li>
<li>Type 'make clean', then 'make'.</li>
<li>Start the MUSH.</li>
<li>Log into the character. Type '@newpassword #1 = NewGodPassword' (substitute whatever you want the new God password to be).</li>
<li>Shut down the MUSH.</li>
<li>Edit src/flags.h again and change the line back to what it was originally.</li>
<li>Type 'make clean', then 'make'.</li>
<li>Start the MUSH.</li>
</ul>
<p >You should now be able to log into the God character with the new password.</p>
<h2><a class="anchor" id="autotoc_md60"></a>
How do logfiles work?</h2>
<p >When you start your game from the command line, the startup information is logged to GAMENAME.log, where GAMENAME is what you specified it to be in your mush.config file.</p>
<p >Subsequently, log information is written to whatever you set your game_log configuration parameter to be in your GAMENAME.conf file (whatever GAMENAME is); if you didn't specify that parameter, 'netmush.log' will be used. In general, you will probably want to set it to GAMENAME.log, so startup information and regular log information are all written to the same file.</p>
<p >You can separate log information of different types into multiple files, using the divert_log configuration parameter. See the wizhelp for details.</p>
<p >When you @restart, or do a @logrotate, the existing logfiles are closed and renamed to LOGNAME.TIMESTAMP, where LOGNAME is the name of the log, and TIMESTAMP is the "epoch time" (equivalent to the number of seconds returned by the secs() MUSH function). You can delete those logfiles to reclaim disk space, if you'd like. The current logfile will always have the "standard" name as specified by the game_log and/or divert_log parameters, though.</p>
<p >When you start the game using the Startmush script, any existing GAMENAME.log files, or log files named by the game_log and divert_log conf parameters, will be renamed to LOGNAME.old (whatever the name of the log happens to be). Any previous logs by those names (with a .TIMESTAMP extension) will be deleted.</p>
<p >When the MUSH is running, you can use, from the game directory, './Logclean' to remove logs with a .TIMESTAMP extension, and './Logclean -o' to remove logs with a .TIMESTAMP or .old extension.</p>
<p >When the MUSH is not running, './Logclean -a' can be used to get rid of all logfiles &ndash; GAMENAME.log, anything named by the game_log and divert_log conf parameters, and their old versions with .TIMESTAMP and .old extensions.</p>
<h2><a class="anchor" id="autotoc_md61"></a>
How do I use multiple guests?</h2>
<p >Using multiple guests is easy, and after you set it up, you'll never have to worry about it again. Here are the steps needed to implement multiple guests:</p>
<ol type="1">
<li>@pcreate a prototype guest character. Name it whatever you want (although you should use a descriptive name like 'Guest'), and use any password you want (it doesn't really matter, as the prototype guest can never connect). Set guest_char_num to the database number of the prototype guest character. Note that this is just the bare number of the object, not a dbref, i.e., 'guest_char_num 5' not 'guest_char_num #5'.</li>
<li>You may want to set the following things on the prototype guest character, which are inherited by every guest character: the amount of money, the zone, the parent, the basic lock, the enter lock, and all attributes. (NOTE: Guests always start off in the room specified by the guest_starting_room, or player_starting_room if that is not specified.)</li>
<li>Set 'number_guests' to the maximum number of guests you wish to support. This number can be as small or as large as you wish.</li>
<li>Optionally, set 'guest_nuker' to a wizard's database number, if you wish to have a wizard other than #1 to nuke the guests.</li>
<li>Set 'guest_basename' to the name you want guests to use when they connect. This defaults to 'Guest'. For instance, if you want guests to type 'connect Visitor' instead of 'connect Guest' to connect, you should do 'guest_basename Visitor'.</li>
<li>Optionally, set 'guest_password' to the password you want guests to have. This defaults to 'guest'. This can be used to reconnect to the same Guest character. Otherwise, players will never see it (any password is acceptable for connecting to a new guest).</li>
<li><p class="startli">Now, you should decide how you want guests to be named. You can name guests using a numbering scheme, i.e., 'Guest1', 'Guest2', 'Guest3' or if you want to specify the list of possible guest names, i.e., 'Werewolf', 'Vampire', 'Skeleton', or if you want guest names to be generated as combinations of words, i.e., 'RedAlien', 'RedVisitor' 'BlueAlien', 'BlueVisitor', 'GreenAlien', 'GreenVisitor' (combinations of 'Red', 'Blue', and 'Green', with 'Alien' and 'Visitor).</p>
<p class="startli">The guest_basename conf parameter is used for the guest numbering scheme, so if you decide to just number your guests, they'll get names of '&lt;guest_basename&gt;&lt;number&gt;'. If you don't use the numbering scheme, guests will receive @aliases of '&lt;guest_basename&gt;&lt;number&gt;', so they're still easy to find.</p>
<p class="startli">If you want to specify a list of guest names, set 'guest_prefixes' to the list of names you want to use. Since the guest names are separated by spaces, they can only be single-word names, i.e., 'guest_prefixes Werewolf Vampire Skeleton'.</p>
<p class="startli">If you want guest names to be generated as combinations of words, set 'guest_prefixes' to the list of the first parts of the name, and 'guest_suffixes' to the list of the second parts of the name, i.e. 'guest_prefixes Red Blue Green', 'guest_suffixes Alien Visitor'.</p>
<p class="startli">If there are more guests that try to connect (up to the number of 'number_guests') than there are available name combinations, extra guests will be named '&lt;guest_basename&gt;&lt;number&gt;'.</p>
<p class="startli">The 'guest_basename' parameter cannot be changed except in the conf file. The 'guest_prefixes' and 'guest_suffixes' parameters can be changed via @admin while the game is running, though. If you would like to randomize the order in which guest names are picked, you can do the following, using your God character:</p>
<p class="startli">&amp;GUEST_CRON me = @admin guest_prefixes=shuffle(config(guest_prefixes)); @admin guest_suffixes=shuffle(config(guest_suffixes))</p>
<p class="startli">@cron me/GUEST_CRON = 0 * * * *</p>
<p class="startli">This will randomize the lists once an hour; if you'd like to do it more frequently, change the @cron to something more frequent.</p>
</li>
</ol>
<p >The file specified by the config parameter 'guest_file' is shown to every guest when they connect. You may wish to use the 'access' config parameter to bar guests from using certain commands, using the 'no_guest' permission. All guests have the 'Guest' power, which is a marker you may use to test whether a player is a guest or not. Guests copy the flags, attributes, parent, and zone of the guest prototype (the guest_char_num object).</p>
<h2><a class="anchor" id="autotoc_md62"></a>
How do I create my own flags? (How do I configure marker flags?)</h2>
<p >You can define your own flags through the use of "marker flags". Flag names and permissions are defined in your conf file.</p>
<p >There are ten marker flags, numbered 0 through 9; 0 through 9 are the single characters representing the flag when the flags of an object are displayed with the dbref when you control/can link to an object, by the flags() function, etc. In order to distinguish these flags from dbref numbers, if they are the only flags set on an object, there will be an underscore ('_') between the dbref and the flags.</p>
<p >An underscore is automatically prepended to the names of marker flags in order to prevent a name conflict with any added flags in future versions of TinyMUSH. You can get around this by defining an alias for the flag without the underscore, but be forewarned that the flag name might end up conflicting with a built-in flag in the future.</p>
<p >For example, the following conf directive:</p>
<p >flag_name 0 CHIEF</p>
<p >creates a flag named "_CHIEF", with the symbol 0. This means that, for instance, that an object with this flag and the PUPPET flag (symbol 'p') might appear on an examine to be: Balloon(#25p0) To set the flag, you would use '@set &lt;object&gt; = _CHIEF'; to unset the flag, you would use '@set &lt;object&gt; = !_CHIEF'.</p>
<p >By default, these flags can only be set by God. In order to change the access restriction, use the flag_access directive. For instance:</p>
<p >flag_access _CHIEF any flag_access _CHIEF wizard</p>
<p >make the _CHIEF flag settable by anyone, and only settable by wizards, respectively.</p>
<p >To alias the flag, use the flag_alias directive:</p>
<p >flag_alias CHIEF _CHIEF</p>
<p >which makes it possible to do '@set &lt;object&gt; = CHIEF'; the caveats listed above about future conflicts with built-ins should be kept in mind, though.</p>
<h2><a class="anchor" id="autotoc_md63"></a>
How do I create "altered reality" realm states like invisibility?</h2>
<p >There are three special locks &ndash; the HeardLock, KnownLock, and MovedLock &ndash; that are only activated by the PRESENCE flag.</p>
<p >When an object which is set PRESENCE tries to speak via a speech command such as "say", "pose", or "@emit", only those objects which pass the speaker's HeardLock are able to hear the message.</p>
<p >When an object does a "look" at a room or otherwise tries to see a target, if the target is set PRESENCE, the object must pass the target's KnownLock. This is also true for messages generated via attributes like @odesc.</p>
<p >When an object which is set PRESENCE moves or tries to move, its movement is only seen by those objects which pass the object's MovedLock.</p>
<p >When an object set PRESENCE wants to hear another thing speak, that thing must pass the object's HearsLock.</p>
<p >When an object set PRESENCE wants to see another thing, that thing must pass the object's KnowsLock.</p>
<p >When an object set PRESENCE wants to notice another thing's movement, that thing must pass the object's MovesLock.</p>
<p >Motion and the ability to see an object already in the room are treated differently, since it's possible that you might want to have something noticed when it's moving, but not when it's still. (For instance, your game might have Ninjas that are invisible when they're just in a room, but are noticed when they move.)</p>
<p >Basic invisibility is a very easy state to implement. Invisible objects are not seen by anyone, whether or not they're static or moving, but they can be heard. They can see and hear other things just fine, though. Thus, to make an object invisible, set it PRESENCE, and @lock/known &lt;object&gt; = #0, and @lock/motion &lt;object&gt; = #0.</p>
<p >A more difficult state is something like the World of Darkness's vampiric Obfuscation. Let's say that vampires have three levels of obfuscation ability, stored on their OBF_ABIL attribute; vampires who have an obfuscation ability higher than a target's can see that target even if they are obfuscated.</p>
<p >That can be done as follows:</p>
<blockquote class="doxtable">
<p >&zwj;@create Obsfucator Obfuscator created as object #11. </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;&amp;OCHECK Obfuscator = [gt(get(%#/OBF_ABIL),get(%@/OBF_ABIL))] @lock Obfuscator = OCHECK/1 </p>
</blockquote>
<p>Now, to allow Vlad to Obfuscate, merely do:</p>
<blockquote class="doxtable">
<p >&zwj;@set *Vlad = PRESENCE @lock/known *Vlad = #11 @lock/motion *Vlad = #11 &amp;OBF_ABIL *Vlad = 1 </p>
</blockquote>
<p>(Clearly more complex implementations are possible and are likely to be desirable; this is just an example.)</p>
<p >Alternatively, take something like the state of a ghost. Let's say that ghosts can see each other and hear each other, but no one else can. They can see the normal world just fine &ndash; but they don't hear everything that's said, they have a random chance of not hearing normal speech. A way to do this might be putting the following in your conf file:</p>
<p >flag_name 0 GHOST</p>
<p >and then @set all your ghostly players _GHOST.</p>
<p >Then, handle the locks:</p>
<blockquote class="doxtable">
<p >&zwj;@create Ghost Ears Ghost Ears created as object #22. </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;&amp;GCHECK Ghost Ears = or(hasflag(%#,_Ghost),rand(2)) @lock Ghost Ears = GCHECK/1 </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;@create Ghost Haze Ghost Haze created as object #33. </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;&amp;HCHECK Ghost Haze = hasflag(%#,_Ghost) @lock Ghost Haze = HCHECK/1 </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;@set *Caspar = PRESENCE @set *Caspar = _GHOST @lock/hears *Caspar = #22 @lock/heard *Caspar = #33 @lock/known *Caspar = #33 @lock/motion *Caspar = #33 </p>
</blockquote>
<p>Fundamentally, you can combine these six locks to end up with any combination of what can hear, be heard, see, be seen, notice, and be noticed.</p>
<h2><a class="anchor" id="autotoc_md64"></a>
How do I tune the database cache?</h2>
<p >Cache tuning is something of a black art. The basic tradeoff is this: If you make your cache larger, it will consume more memory, but you will (hopefully) need fewer disk accesses to get needed data, which will therefore be faster. However, if you consume too much memory, the operating system will begin to page random bits of your MUSH on and off of disk &ndash; you are better off staying small enough to not have that happen, and do your own getting data on and off disk.</p>
<p >TinyMUSH 3.1 allows you to limit the total amount of cache memory the server consumes. This defaults to 1,000,000 bytes, or just under 1 MB of RAM. The size of the cache can be changed with the cache_size parameter in your conf file. We recommend that you don't set this value any lower, except on private or very small games. Otherwise, take a look at the size of your netmush.gdbm file via ls -l netmush.gdbm &ndash; the file's size in bytes should be next to its last-modified date. (If your GDBM file is not called netmush.gdbm, use whatever filename it's called.) You should never set your cache size larger than the size of this file.</p>
<p >The optimal cache size is dependent on a number of different factors; these include the size of your master room objects, the number of players you have logged on at a time, and how much they move around. Generally any object which is 'used' by a player is cached; this includes rooms and exits, as well as objects in their inventory. Thus your cache size really shouldn't depend on the total size of your database, but on the size of the active playerbase, often-used softcode, and the areas your players typically move around in. Take a look at your @list cache sometime to determine what kind of objects are being cached.</p>
<p >Let your game run for a few hours with normal player activity. Check '@list db_stats' and look at the Cache Size reported, and the Hit Ratio for Reads. You want the latter to be in the 90-97% range. If your actual reported cache size is much lower than your configured cache_size and your hit ratio is still in that range, then you should be able to safely lower cache_size in the future. If your hit ratio is low, try increasing the cache size (though eventually there will be a trade-off in paging behavior if the process becomes too large).</p>
<p >You can also tune the cache width; this is the number of 'buckets' that cache entries are spread out over. For the vast majority of games the default if okay. If you want to tune this, take a look at the number of attributes being cached in '@list cache', divide this number by 50, and use that as your cache width.</p>
<h2><a class="anchor" id="autotoc_md65"></a>
How do I use the in-memory database?</h2>
<p >Follow the 'Basic Installition' steps in the INSTALL file, with one exception: specify '&ndash;disable-disk-based' as an argument to configure (step 5). Please note that unlike previous versions, TinyMUSH 3.1 uses GDBM for its memory-based database instead of a flatfile. You can still create a flatfile using the Backup script the same way you would for a disk-based game.</p>
<h2><a class="anchor" id="autotoc_md66"></a>
Help! I'm having database problems.</h2>
<p >Almost everyone who runs a MUSH experiences a database disaster at least once in their life. There can be many reasons for this; common ones include an NFS server dying, running out of disk space, overflowing your disk quota, a nasty game crash, and a nasty system crash.</p>
<p >Typically, in this scenario, the server process either dumps core during an attempt to load the database, or simply hangs; sometimes, it may come back up and large chunks of your data may be missing.</p>
<p >Sometimes, simply by flatfiling and reloading the flatfile (doing a Backup and a Restore), integrity issues that cause the database to fail to load can be dealt with. Be aware that you might experience some minor data loss in the process, though.</p>
<p >However, your best bet in this scenario is to restore your database from backup. This means it's very important to keep backups; we strongly recommend that you back up once a week at minimum, if not nightly.</p>
<p >If you don't have a recent backup you can restore from, you can try a database reconstruction. This is likely to be most effective if you have corruption resulting from a host machine crash or disk problem; you might not be able to get back all of your data, but it'll at least be something. If you haven't moved any files around, you can just go into the game directory and type './Reconstruct'. If it completes successfully, you can try to start it up with './Startmush' (though doing a './Backup' first would be a good idea). If it doesn't complete successfully, you'll need to revert to a backup.</p>
<h2><a class="anchor" id="autotoc_md67"></a>
How do I set up a link to an external SQL database?</h2>
<p >There is built-in support in TinyMUSH 3 for connecting to an external mSQL or MySQL database. If you want to do this, you'll need to compile in the appropriate file (see ./configure &ndash;help for how to do this).</p>
<p >You can also look at <a class="el" href="db__sql_8h.html" title="Module for SQL interface.">db_sql.h</a>, db_msql.c, and db_mysql.c for examples of how to write your own method of connecting to another type of external SQL database. If you do this, please let us know, and provide us with a copy of the code, so it can be included with the next TinyMUSH release.</p>
<p >The rest of this answer uses mSQL as a specific example; MySQL and other database systems have similar requirements.</p>
<p >You'll need to have an mSQL 2.x database set up. mSQL can be obtained from <a href="http://www.hughes.com.au/">http://www.hughes.com.au/</a> together with the appropriate documentation. We do not support the mSQL package itself; if you need help with mSQL installation, configuration, and maintenance, please refer to the mSQL pages for assistance.</p>
<p >If the mSQL database is on the same machine as your MUSH, the sql_host parameter in your netmush.conf file (or equivalent) should be set to "localhost", so the local Unix domain socket is used; if the database is not on the same machine as your MUSH, the sql_host parameter should be whatever the remote server's hostname is.</p>
<p >You then need to create a database in mSQL for the MUSH to use (or you can, of course, use an existing database). You can do this with:</p>
<p >msqladmin create MUSH_DB</p>
<p >... which creates a database called MUSH_DB. You can then add the parameter 'sql_database MUSH_DB' to your netmush.conf file.</p>
<p >Make sure that you set up your mSQL installation's msql.acl file correctly and with the appropriate level of security. See mSQL's own documentation for assistance with this.</p>
<p >The database link should come up automatically when the game is first started. You should see logfile messages that look something like this, after the 'Load complete.' note in the log:</p>
<p >990831.115339 TinyMUSH SQL/CONN : Connected to SQL server. 990831.115339 TinyMUSH SQL/CONN : SQL database selected.</p>
<p >You should then be able to use the SQL() function from within the MUSH to make queries against this database. Note that users of this function need to have the use_sql power.</p>
<p >Note for MySQL users: you may need to specify a username/password to connect to the database; use the sql_username and sql_password config parameters. These parameters have no effect for mSQL.</p>
<hr  />
 <h1><a class="anchor" id="autotoc_md69"></a>
### If you have suggestions for more FAQs, please email us and let us know.</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
