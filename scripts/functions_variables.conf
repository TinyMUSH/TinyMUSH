# TinyMUSH Regression Tests - Variable Functions
# Functions: clearvars(), let(), lvars(), regparse(), regparsei(), setx(), store(), wildparse(), x(), xvars()
# Format: command | expected substring
#
# NOTE: Tests for regparse/regparsei with capture groups are omitted due to
#       parentheses parsing conflicts in the config format. These functions
#       support PCRE regex with capturing groups; see 'help regparse' in-game.

# Test x() and setx(): get and set variable
think setx(myvar,hello)
think x(myvar) | hello

# Test store(): set and return value
think store(counter,42) | 42
think x(counter) | 42

# Test xvars(): set multiple variables from lists
think xvars(a b c,1 2 3)
think x(a) | 1
think x(b) | 2
think x(c) | 3

# Test xvars() with custom delimiter
think xvars(x y z,10~20~30,~)
think x(x) | 10
think x(y) | 20
think x(z) | 30

# Test xvars() with empty list clears variables
think xvars(a b c,)
think strlen(x(a)) | 0
think strlen(x(b)) | 0

# Test lvars(): list variables
think setx(testvar,value)
think gt(match(lvars(),testvar),0) | 1

# Test let(): scoped variables with restoration
think setx(temp,original)
think let(temp,modified,x(temp)) | modified
think x(temp) | original

# Test let() with multiple variables
think let(p q,5 10,add(x(p),x(q))) | 15

# Test let() with empty values restores to null
think setx(reset,data)
think let(reset,,x(reset))
think x(reset) | data

# Test wildparse(): match wildcards into variables
think wildparse(foo bar baz,* * *,w1 w2 w3)
think x(w1) | foo
think x(w2) | bar
think x(w3) | baz

# Test wildparse() with simple wildcards
think wildparse(test123,test*,num)
think x(num) | 123

# Test regparse(): basic match without captures
think regparse(hello,hello,r0)
think x(r0) | hello

# Test regparse() with pattern match
think regparse(test123,test.+,m0)
think x(m0) | test123

# Test regparsei(): case-insensitive regex
think regparsei(HELLO,hello,i0)
think x(i0) | HELLO

# Test clearvars(): remove all variables
think setx(toclean,value)
think clearvars()
think strlen(x(toclean)) | 0
think strlen(lvars()) | 0
