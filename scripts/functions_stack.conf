# TinyMUSH Regression Tests - Stack Functions
# Covers: dup(), empty(), items(), lstack(), peek(), pop(), popn(), push(), swap(), toss()
# Notes:
# - Stack is per-object; default target is the player.
# - Top-of-stack is printed first by lstack(); positions are 0-based from top.

# Reset stack and verify empty
think empty()
think items() | 0

# Push two items and verify order (top-first)
think push(apple)
think push(banana)
think items() | 2
think eq(first(lstack()),banana) | 1

# Peek top without removal
think eq(peek(),banana) | 1
think items() | 2

# Pop top with removal
think eq(pop(),banana) | 1
think items() | 1
think eq(first(lstack()),apple) | 1

# Duplicate top item
think push(cherry)
think items() | 2
think dup()
think items() | 3
think eq(first(lstack()),cherry) | 1
think eq(first(rest(lstack())),cherry) | 1

# Swap top two items
think push(date)
think eq(first(lstack()),date) | 1
think swap()
think eq(first(lstack()),cherry) | 1
think eq(first(rest(lstack())),date) | 1
think items() | 4

# Toss (discard) top without output
think toss()
think items() | 3
think eq(first(lstack()),date) | 1

# popn(): pop N items starting at position with delimiter
# Current stack expected: [date, cherry, apple] top-first
think eq(popn(me,0,2,:),date:cherry) | 1
think items() | 1
think eq(first(lstack()),apple) | 1

# pop/peek with explicit position on object
think push(egg)
think push(fig)
# Stack: [fig, egg, apple]
think eq(pop(me,1),egg) | 1
think items() | 2
think eq(peek(me,1),apple) | 1
think items() | 2

# lstack with custom delimiter
think eq(lstack(me,:),fig:apple) | 1

# Clear stack via empty(object)
think empty(me)
think items() | 0
