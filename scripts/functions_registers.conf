# =============================================================================
# TinyMUSH Regression Tests - Register Functions
# =============================================================================
# Functions tested: setq(), setr(), r(), lregs(), qvars(), qsub()
# =============================================================================

# setq() argument validation
think setq(0) | #-1 FUNCTION (SETQ) EXPECTS AT LEAST 2 ARGUMENTS
think setq(0,foo,1) | #-1 FUNCTION (SETQ) EXPECTS AN EVEN NUMBER OF ARGUMENTS

# setq() sets registers
think [setq(0,Alpha)][r(0)] | Alpha
think [setq(0,Zero,1,One,foo,Bar)][r(0)] [r(1)] [r(foo)] | Zero One Bar

# setr() sets and returns the value
think setr(1,Returned) | Returned
think setr(!,X) | #-1 INVALID GLOBAL REGISTER

# r() reads registers (invalid names currently return empty)
think r(!) |
think [setq(foo,Bar)][r(foo)] | Bar

# lregs() lists non-empty registers
think [setq(0,Zero,1,One,foo,Bar)][lregs()] | 0 1 foo

# qvars() maps list elements to registers
think [qvars(0 1 foo,apple;banana;cherry,;)][r(0)] [r(1)] [r(foo)] | apple banana cherry
think qvars(0 1,apple;banana;cherry,;) | #-1 LISTS MUST BE OF EQUAL SIZE

# qsub() substitution with default markers
think [setq(0,HELLO,foo,WORLD)][qsub($0$-$foo$)] | HELLO-WORLD
think qsub(Value:$missing$.) | Value:.

# qsub() with custom markers
think [setq(foo,WORLD)][qsub(Hello #foo#!,#,#)] | Hello WORLD!
